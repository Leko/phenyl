// @flow
import type {
  RequestData
} from './request-data.js.flow'
import type {
  WhereQuery,
  IdQuery,
  IdsQuery,
  CustomQuery,
  PullQuery,
} from './query.js.flow'
import type {
  TypeMap,
  EntityOf,
  EntityNameOf,
  CustomQueryNameOf,
  QueryParamsOf,
  CustomCommandNameOf,
  CommandParamsOf,
  UserEntityNameOf,
  CredentialsOf,
  OptionsOf,
} from './type-map.js.flow'

import type {
  SingleInsertCommand,
  MultiInsertCommand,
  IdUpdateCommand,
  MultiUpdateCommand,
  DeleteCommand,
  CustomCommand,
  LoginCommand,
  LogoutCommand,
  PushCommand,
} from './command.js.flow'

export type RequestDataHandlers<TM: TypeMap, T> = {
  handleDefault: (reqData: RequestData<TM, *, *, *, *>) => Promise<T>,

  find?: (query: WhereQuery<EntityNameOf<TM>>) => Promise<T>,
  findOne?: (query: WhereQuery<EntityNameOf<TM>>) => Promise<T>,
  get?: (query: IdQuery<EntityNameOf<TM>>) => Promise<T>,
  getByIds?: (query: IdsQuery<EntityNameOf<TM>>) => Promise<T>,
  pull?: (query: PullQuery<EntityNameOf<TM>>) => Promise<T>,
  insertOne?: <N: EntityNameOf<TM>>(command: SingleInsertCommand<N, EntityOf<TM, N>>) => Promise<T>,
  insertMulti?: <N: EntityNameOf<TM>>(command: MultiInsertCommand<N, EntityOf<TM, N>>) => Promise<T>,
  insertAndGet?: <N: EntityNameOf<TM>>(command: SingleInsertCommand<N, EntityOf<TM, N>>) => Promise<T>,
  insertAndGetMulti?: <N: EntityNameOf<TM>>(command: MultiInsertCommand<N, EntityOf<TM, N>>) => Promise<T>,
  updateById?: (command: IdUpdateCommand<EntityNameOf<TM>>) => Promise<T>,
  updateMulti?: (command: MultiUpdateCommand<EntityNameOf<TM>>) => Promise<T>,
  updateAndGet?: (command: IdUpdateCommand<EntityNameOf<TM>>) => Promise<T>,
  updateAndFetch?: (command: MultiUpdateCommand<EntityNameOf<TM>>) => Promise<T>,
  push?: (command: PushCommand<EntityNameOf<TM>>) => Promise<T>,
  delete?: (command: DeleteCommand<EntityNameOf<TM>>) => Promise<T>,
  runCustomQuery?: <N: CustomQueryNameOf<TM>>(query: CustomQuery<N, QueryParamsOf<TM, N>>) => Promise<T>,
  runCustomCommand?: <N: CustomCommandNameOf<TM>>(command: CustomCommand<N, CommandParamsOf<TM, N>>) => Promise<T>,
  login?: <N: UserEntityNameOf<TM>>(command: LoginCommand<N, CredentialsOf<TM, N>, OptionsOf<TM, N>>) => Promise<T>,
  logout?: <N: UserEntityNameOf<TM>>(command: LogoutCommand<N>) => Promise<T>,

  notMatch?: (reqData: RequestData<TM, *, *, *, *>) => Promise<T>,
}
